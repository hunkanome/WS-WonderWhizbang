<!DOCTYPE html>
<html>

<head>
    <title>WonderWhizbang</title>
    <meta charset="utf-8">
    <meta name="description" content="Moteur de recherche dédié au patrimoine mondial de l'UNESCO">
    <meta name="keywords" content="UNESCO, patrimoine, culture">
    <meta name="author" content="Hunkanome">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script async src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script src="scripts/europeana.js"></script>
    <script src="scripts/dbpedia.js"></script>
    <script src="scripts/utils.js"></script>
    <link rel="stylesheet" href="static/css/styles.css">
</head>

<body>
    <h1>WonderWhizbang</h1>
    <p>Moteur de recherche dédié au patrimoine mondial de l'UNESCO</p>
    <input type="text" name="search" class="form-control" placeholder="Rechercher...">
    <button type="button" class="btn btn-primary">Rechercher</button>

    <!-- Random monument each time you refresh the page -->
    <main class="container">
        <div class="row">
            <article class="col-8 offset-2 row">
                <div class="col-6">
                    <h2 id="title">Title</h2>
                    <p id="description">Description</p>
                </div>
                <div class="col-6 row">
                    <img id="picture" src="https://via.placeholder.com/150">
                </div>
            </article>
        </div>
    </main>

    <script>
        // Get a monument list from DBpedia
        var query = `
            PREFIX dbo: <http://dbpedia.org/ontology/>
            PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

            SELECT ?monumentLabel ?picture ?desc WHERE {
            ?monument a dbo:WorldHeritageSite .
            ?monument rdfs:label ?monumentLabel .
            ?monument dbo:abstract ?desc .
            ?monument foaf:depiction ?picture .
            FILTER (lang(?monumentLabel) = "fr")
            FILTER (lang(?desc) = "fr") 
            }
            LIMIT 1
            OFFSET ${Math.floor(Math.random() * 1000)}
        `;

        // Send the query to the SPARQL endpoint
        requestDBpedia(query)
        .then(data => {
            data = formatResult(data);
            var monument = data[0];
            var monumentName = monument.monumentLabel.value;
            var picture = data[0].picture.value;

            document.getElementById("picture").src = picture;
            document.getElementById("title").innerHTML = monumentName;
            document.getElementById("description").innerHTML = data[0].desc.value;
        });
    </script>
</body>

</html>